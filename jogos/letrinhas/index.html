<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Jogo das Letrinhas</title>
  <!-- TODO O SEU CSS PERMANECE IGUAL -->
</head>
<body>
  <button id="menuButton">Menu de Jogos</button>
  <div class="menu">
    <button onclick="setCategory('animais')">Animais</button>
    <button onclick="setCategory('frutas')">Frutas</button>
    <button onclick="setCategory('objetos')">Objetos</button>
  </div>

  <div class="game-container">
    <p id="wordToCopy">Palavra:</p>
    <input type="text" id="customWord" placeholder="Digite a palavra que deseja">
    <button onclick="setCustomWord()">Usar Palavra</button>
    <div id="dropZone"></div>
    <div id="letterBank"></div>
    <button onclick="checkWord()">Verificar</button>
    <p id="message"></p>
  </div>

  <canvas id="confettiCanvas"></canvas>

  <script>
    /* üîπ LINHAS NOVAS (substituem o currentWord fixo) */
    let currentCategory = "animais";
    let currentWord = "";

    const words = {
      animais: [
        "cachorro","gato","elefante","le√£o","tigre","girafa","zebra","macaco",
        "urso","coelho","cavalo","vaca","ovelha","porco","galinha","pato",
        "papagaio","cobra","tartaruga","jacar√©","golfinho","baleia","tubar√£o",
        "pinguim","√°guia"
      ],
      frutas: [
        "ma√ß√£","banana","uva","laranja","pera","abacaxi","manga","morango",
        "melancia","mam√£o","kiwi","lim√£o","cereja","p√™ssego","ameixa","abacate",
        "coco","figo","goiaba","maracuj√°","tangerina","framboesa","mirtilo",
        "rom√£","caqui"
      ],
      objetos: [
        "mesa","cadeira","computador","bola","livro","telefone","caneta",
        "l√°pis","caderno","mochila","rel√≥gio","televis√£o","controle","sof√°",
        "arm√°rio","copo","prato","garrafa","tesoura","espelho","ventilador",
        "lumin√°ria","teclado","mouse","tapete"
      ]
    };

    document.getElementById("menuButton").onclick = function() {
      window.location.href = "../index.html";
    };

    /* üîπ FUN√á√ÉO ATUALIZADA (mant√©m categoria atual) */
    function setCategory(category) {
      currentCategory = category;
      const randomIndex = Math.floor(Math.random() * words[category].length);
      currentWord = words[category][randomIndex];
      setupGame();
    }

    function setCustomWord() {
      const input = document.getElementById("customWord").value.trim();
      if (input) {
        currentWord = input.toLowerCase();
        setupGame();
      }
    }

    function setupGame() {
      document.getElementById("wordToCopy").textContent = "Palavra: " + currentWord;
      const dropZone = document.getElementById("dropZone");
      dropZone.innerHTML = "";

      for (let i = 0; i < currentWord.length; i++) {
        let slot = document.createElement("div");
        slot.className = "dropSlot";
        slot.onclick = () => removeLetter(slot);
        slot.ondrop = drop;
        slot.ondragover = allowDrop;
        dropZone.appendChild(slot);
      }

      const letterBank = document.getElementById("letterBank");
      letterBank.innerHTML = "";
      let shuffled = currentWord.split("").sort(() => Math.random() - 0.5);

      shuffled.forEach((letter, index) => {
        let div = document.createElement("div");
        div.className = "letter";
        div.textContent = letter;
        div.id = "letter-" + index;
        div.draggable = true;
        div.ondragstart = drag;
        div.onclick = () => placeLetter(div);
        letterBank.appendChild(div);
      });

      document.getElementById("message").textContent = "";
    }

    function allowDrop(ev) { ev.preventDefault(); }

    function drag(ev) {
      ev.dataTransfer.setData("text", ev.target.textContent);
      ev.dataTransfer.setData("id", ev.target.id);
    }

    function drop(ev) {
      ev.preventDefault();
      if (ev.target.classList.contains("dropSlot") && ev.target.textContent === "") {
        let letter = ev.dataTransfer.getData("text");
        let id = ev.dataTransfer.getData("id");
        ev.target.textContent = letter;
        ev.target.classList.add("filled");
        document.getElementById(id).remove();
      }
    }

    function placeLetter(div) {
      let slots = document.querySelectorAll(".dropSlot");
      for (let slot of slots) {
        if (slot.textContent === "") {
          slot.textContent = div.textContent;
          slot.classList.add("filled");
          div.remove();
          break;
        }
      }
    }

    function removeLetter(slot) {
      if (slot.textContent !== "") {
        let div = document.createElement("div");
        div.className = "letter";
        div.textContent = slot.textContent;
        div.draggable = true;
        div.ondragstart = drag;
        div.onclick = () => placeLetter(div);
        document.getElementById("letterBank").appendChild(div);
        slot.textContent = "";
        slot.classList.remove("filled");
      }
    }

    function checkWord() {
      let formedWord = "";
      document.querySelectorAll(".dropSlot").forEach(slot => {
        formedWord += slot.textContent;
      });

      if (formedWord === currentWord) {
        document.getElementById("message").textContent = "Parab√©ns! Voc√™ acertou!";
        document.getElementById("message").style.color = "#21d578";
        startConfetti();

        /* üîπ LINHA CORRIGIDA (permanece na categoria atual) */
        setTimeout(() => { setCategory(currentCategory); }, 3000);

      } else {
        document.getElementById("message").textContent = "Tente novamente!";
        document.getElementById("message").style.color = "#ff4081";
      }
    }

    /* üîπ IN√çCIO ALEAT√ìRIO DO JOGO */
    setCategory("animais");
  </script>
</body>
</html>
