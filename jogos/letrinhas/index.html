<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Letrinhas - MusiKids Fun</title>
<style>
  body {
    margin: 0;
    padding: 0;
    font-family: 'Baloo 2', cursive, Arial;
    background: linear-gradient(135deg, #e5f7cb 0%, #ffced5 100%);
    color: #222;
    user-select: none;
    text-align: center;
    min-height: 100vh;
  }
  header {
    font-size: 2.2rem;
    font-weight: 900;
    color: #dc4588;
    margin: 0.7rem 0 0.2rem 0;
    user-select: none;
  }
  #btn-menu {
    position: fixed;
    top: 15px;
    left: 15px;
    background: #a1d578;
    color: #35510e;
    border-radius: 1.3rem;
    border: none;
    font-weight: 900;
    font-size: 1.2rem;
    padding: 0.6rem 1.4rem;
    cursor: pointer;
    box-shadow: 0 0 14px #aad87a95;
    user-select: none;
    z-index: 1000;
    transition: background-color 0.25s;
  }
  #btn-menu:hover {
    background: #779e37;
    color: white;
  }
  #main-container {
    max-width: 600px;
    margin: 5rem auto 0 auto;
    display: flex;
    flex-direction: column;
    align-items: center;
  }
  #categoria-container {
    margin-bottom: 1rem;
  }
  select, input, button {
    font-family: 'Baloo 2', cursive, Arial;
  }
  select {
    font-size: 1.1rem;
    padding: 0.4rem 0.8rem;
    border-radius: 1.2rem;
    border: 2px solid #a1d578;
    margin-right: 0.8rem;
  }
  input[type=text] {
    padding: 0.6rem 1.0rem;
    font-size: 1.0rem;
    border-radius: 1.2rem;
    border: 2px solid #a1d578;
    width: 190px;
    margin-top: 1rem;
  }
  button#add-btn {
    font-size: 1.0rem;
    font-weight: 900;
    border-radius: 1.4rem;
    border: none;
    background: #ff7998;
    color: white;
    cursor: pointer;
    padding: 0.5rem 1.4rem;
    margin-left: 0.8rem;
    box-shadow: 0 0 12px #f74885aa;
    user-select: none;
    margin-top: 1rem;
  }
  button#add-btn:hover {
    background: #de2c67;
  }
  #instrucao {
    font-weight: 600;
    font-size: 1.13rem;
    margin-bottom: 1rem;
    color: #d22f79;
    user-select: none;
  }
  #palavra-atual {
    font-size: 1.7rem;
    font-weight: 900;
    color: #277021;
    background: #f2ffdc;
    border-radius: 1rem;
    padding: 1rem 3rem;
    box-shadow: 0 0 10px #90d775aa;
    margin-bottom: 1.5rem;
    user-select: none;
  }
  #caixa-letras {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    gap: 1rem;
    margin-bottom: 1.7rem;
    min-height: 3rem;
  }
  .letra-drag {
    display: inline-block;
    cursor: grab;
    user-select: none;
    font-weight: 900;
    font-size: 1.3rem;
    background:linear-gradient(135deg,#ff8ab3 0%,#a1de79 100%);
    border-radius: 1.3rem;
    padding: 8px 20px;
    color: #222;
    border: 2px solid #fff;
    box-shadow: 0 0 12px #ea466880;
    transition: all 0.15s ease;
  }
  .letra-drag.dragging {
    opacity: 0.25;
    background-color: #ffc5cb;
    cursor: grabbing;
  }
  #slots-palavra {
    display:flex;
    justify-content: center;
    gap: 1.3rem;
    margin-bottom: 1.8rem;
  }
  .slot-letra {
    width: 3.1rem;
    height: 3.1rem;
    background: #ffecf7;
    border: 2px dashed #d72e77;
    border-radius: 1rem;
    font-weight: 900;
    font-size: 2rem;
    text-transform: uppercase;
    color: #1a872c;
    touch-action: none;
    user-select: none;
    cursor: pointer;
    display: flex;
    justify-content: center;
    align-items: center;
  }
  .slot-letra.over {
    background-color: #fffdd0;
    border-color: #fc0;
  }
  #next-btn, #reset-btn {
    padding: 0.8rem 3rem;
    font-size: 1.2rem;
    font-weight: 900;
    border-radius: 1.7rem;
    border: none;
    color: white;
    cursor: pointer;
    user-select: none;
    transition: background-color 0.3s ease;
    box-shadow: 0 0 15px #e4317caa;
  }
  #next-btn {
    background: linear-gradient(90deg,#f0b2c7 0%,#f64187 97%);
    margin-bottom: 0.75rem;
    display: none;
  }
  #next-btn:hover {
    background: linear-gradient(90deg,#f14973 0%,#e9055b 97%);
  }
  #reset-btn {
    background: linear-gradient(90deg,#b0da25 0%,#239e4c 97%);
  }
  #reset-btn:hover {
    background: linear-gradient(90deg,#519e32 0%,#1f5c29 97%);
  }
  #resultado {
    font-size: 1.6rem;
    font-weight: 900;
    color: #9f2492;
    min-height: 3.5rem;
    user-select: none;
  }
  #confetti {
    pointer-events: none;
    position: fixed;
    width: 100vw;
    height: 100vh;
    top: 0; left: 0;
    z-index: 2000;
  }
  .confetti-piece {
    position: absolute;
    width: 8px; height: 8px;
    background-color: red;
    border-radius: 50%;
    will-change: transform, opacity;
  }
</style>
</head>
<body>
  <header>Letrinhas - MusiKids Fun</header>
  <button id="btn-menu" onclick="window.location.href='../'">MENU DE JOGOS</button>
  <div id="main-container">
    <div id="categoria-container">
      <select id="categoria-escolha" aria-label="Seleção de categoria">
        <option value="animais">Animais</option>
        <option value="objetos">Objetos</option>
        <option value="frutas">Frutas</option>
        <option value="nomes">Nomes</option>
      </select>
    </div>
    <div id="area-add">
      <input type="text" id="add-palavra" maxlength="15" placeholder="Digite palavra" aria-label="Adicionar palavra"/>
      <button id="btn-add">Adicionar</button>
    </div>
    <div id="instrucao">Arraste as letras para formar a palavra!</div>
    <div id="palavra-atual"></div>
    <div id="caixa-letras"></div>
    <div id="slots-palavra"></div>
    <button id="next-btn">Próxima Palavra</button>
    <button id="reset-btn">Refazer</button>
    <div id="resultado"></div>
    <div id="confetti"></div>
  </div>
<script>
  const categorias = {
    animais: ["GATO","CACHORRO","PATO","VACA","PERU","RATO","ANJO","ABELHA","ELEFANTE","RAPOSA","COELHO","PEIXE","TOURO","URSO","GORILA","LAGARTO","MACACO","GALINHA","CAVALO","POMBO","TIGRE","PAPAGAIO","GALINHA","LEAO","PORCO","CAVALO","ONÇA","FURAO","URSO","TAPIR","MINHOCA","GIRAFINHA","LCEO","HIPOPOTAMO","CAVALO","TUCANO"],
    objetos: ["BOLA","MESA","CAIXA","CAMISA","SITE","CHALE","JABUTI","MESA","PORTA","TELA","LIVRO","CANETA","FITA","SOL","TESOURA","ARMARIO","LANÇA","PENELOPE","BOLSA","CPU","BOTELHO","BICICLETA","GORO","ESTCAO","PORTICO","MARIA","CAIXA","TELEFONE"],
    frutas: ["MANGA","LARANJA","UVA","BANANA","ABACATE","MARACUJA","GOIABA","AMORA","MORANGOS","MELAO","JAMBALAIA","JOCOTI","GUAVA","JABUTIBA","LENHA","CEARA","ELMIRAM", "AVAI", "ANEA", "RIA"],
    nomes: ["ANA","LUIZ","MARIA","PEDRO","JOAO","CARLOS","FERNANDO","AMANDA","PATRICIA","HELENA","BRUNO","JESSE","LUCAS","FABIO","MARCIO","MONICA","IGOR","ARTHUR"]
  };
  
  let categoriaAtual = 'animais';
  let palavras = [];
  let indice = 0;
  let letrasRestantes = [];
  let slots = [];
  let draggingIdx = null;
  let palavrasAdicionadas = [];
  
  // Funções embaralhar palavras e letras
  function shuffle(array) {
    let arr = array.slice();
    for(let i = arr.length -1; i > 0; i--){
      let j = Math.floor(Math.random() * (i +1));
      [arr[i], arr[j]] = [arr[j], arr[i]];
    }
    return arr;
  }
  function shuffleWord(word) {
    return word.split('').sort(() => Math.random() - 0.5);
  }
  // Exibir palavra e montar slots e letras embaralhadas
  function showWord() {
    let palavra = palavras[indice];
    document.getElementById('palavra-atual').innerText = palavra;
    buildSlots(palavra);
    buildLetters(palavra);
    document.getElementById('resultado').innerText = '';
    document.getElementById('next-btn').style.display = 'none';
    document.getElementById('reset-btn').style.display = 'inline';
  }
  function buildSlots(palavra) {
    let container = document.getElementById('slots-palavra');
    container.innerHTML = '';
    slots = [];
    for(let i=0; i<palavra.length; i++) {
      let slot = document.createElement('div');
      slot.className = 'slot-letra';
      slot.dataset.index = i;
      slot.addEventListener('dragover', e=> {
        e.preventDefault();
        slot.classList.add('over');
      });
      slot.addEventListener('dragleave', e=> {
        slot.classList.remove('over');
      });
      slot.addEventListener('drop', e=> {
        e.preventDefault();
        slot.classList.remove('over');
        if(slot.innerText === '') {
          let letra = letrasRestantes[draggingIdx];
          slot.innerText = letra;
          letrasRestantes[draggingIdx] = null;
          updateLetters();
          checkResult();
        }
      });
      // Permite tirar letra do slot clicando nela
      slot.addEventListener('click', ()=> {
        if(slot.innerText !== '') {
          letrasRestantes.push(slot.innerText);
          slot.innerText = '';
          updateLetters();
          checkResult();
        }
      });
      slots.push(slot);
      container.appendChild(slot);
    }
  }
  function buildLetters(palavra) {
    letrasRestantes = shuffleWord(palavra);
    updateLetters();
  }
  function updateLetters() {
    let container = document.getElementById('caixa-letras');
    container.innerHTML = '';
    letrasRestantes.forEach((letra, idx) => {
      if(letra !== null && letra !== undefined) {
        let letterDiv = document.createElement('div');
        letterDiv.className = 'letra-drag';
        letterDiv.innerText = letra;
        letterDiv.draggable = true;
        letterDiv.addEventListener('dragstart', () => {
          draggingIdx = idx;
          letterDiv.classList.add('dragging');
        });
        letterDiv.addEventListener('dragend', () => {
          letterDiv.classList.remove('dragging');
          draggingIdx = null;
        });
        container.appendChild(letterDiv);
      }
    });
  }
  function checkResult() {
    if(slots.every(slot=>slot.innerText !== '')) {
      let result = true;
      for(let i=0; i<slots.length; i++) {
        if(slots[i].innerText !== palavras[indice][i]) {
          result = false;
          break;
        }
      }
      let resMsg = document.getElementById('resultado');
      let btnNext = document.getElementById('next-btn');
      let btnReset = document.getElementById('reset-btn');
      if(result) {
        resMsg.innerText = 'Parabéns! Você acertou!';
        btnNext.style.display = 'inline-block';
        btnReset.style.display = 'none';
        confetti();
      } else {
        resMsg.innerText = 'Tente novamente!';
        btnNext.style.display = 'none';
        btnReset.style.display = 'inline-block';
      }
    } else {
      let resMsg = document.getElementById('resultado');
      let btnNext = document.getElementById('next-btn');
      let btnReset = document.getElementById('reset-btn');
      resMsg.innerText = '';
      btnNext.style.display = 'none';
      btnReset.style.display = 'inline-block';
    }
  }
  document.getElementById('next-btn').onclick = () => {
    indice++;
    if(indice >= palavras.length) indice = 0;
    showWord();
  };
  document.getElementById('reset-btn').onclick = () => {
    buildLetters(palavras[indice]);
    slots.forEach(s => s.innerText = '');
    document.getElementById('resultado').innerText = '';
  };
  document.getElementById('categoria-escolha').onchange = function(e) {
    categoriaAtual = e.target.value;
    palavras = shuffle(categorias[categoriaAtual]);
    indice = 0;
    showWord();
  };
  document.getElementById('btn-add').onclick = function() {
    let input = document.getElementById('add-palavra');
    let nova = input.value.trim().toUpperCase();
    if(nova.length >= 2 && /^[A-ZÇÁÉÍÓÚ]+$/.test(nova)) {
      categorias[categoriaAtual].unshift(nova);
      palavras = categorias[categoriaAtual].slice();
      indice = 0;
      showWord();
      input.value = '';
    } else {
      input.style.animation = 'shake 0.3s';
      setTimeout(() => input.style.animation = '', 300);
      input.focus();
    }
  };
  // Confetti function
  function confetti() {
    let container = document.getElementById('confetti');
    container.innerHTML = '';
    let colors = ['#ff3980','#ff98a2','#fff89a','#a2e87e','#7de8a1'];
    for(let i=0; i<100; i++) {
      let conf = document.createElement('div');
      conf.className = 'confetti-piece';
      conf.style.backgroundColor = colors[Math.floor(Math.random()*colors.length)];
      conf.style.top = (window.innerHeight*Math.random()) + 'px';
      conf.style.left = (window.innerWidth*Math.random()) + 'px';
      conf.style.width = '7px';
      conf.style.height = '7px';
      conf.style.position = 'absolute';
      conf.style.borderRadius = '50%';
      conf.style.opacity = '1';
      conf.style.zIndex = 9999;
      conf.style.animation = `fall 3s linear forwards`;
      conf.style.animationDelay = (i*0.03) + 's';
      container.appendChild(conf);
    }
    setTimeout(() => {container.innerHTML = '';}, 3000);
  }
  // Keyframes for confetti animation
  const style = document.createElement('style');
  style.innerHTML = `
    @keyframes fall {
      0% { transform: translateY(0); opacity: 1; }
      100% { transform: translateY(100vh); opacity: 0; }
    }
    @keyframes shake {
      0% { transform: translateX(0); }
      25% { transform: translateX(5px); }
      50% { transform: translateX(-5px); }
      75% { transform: translateX(5px); }
      100% { transform: translateX(0); }
    }
  `;
  document.head.appendChild(style);
  // Initialize with random order
  palavras = shuffle(categorias[categoriaAtual]);
  showWord();
</script>
</body>
</html>
