<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Jogo das Letrinhas</title>
<style>
/* SEU CSS – 100% INTACTO */
</style>
</head>

<body>
<button id="menuButton">Menu de Jogos</button>

<div class="menu">
  <button onclick="setCategory('animais')">Animais</button>
  <button onclick="setCategory('frutas')">Frutas</button>
  <button onclick="setCategory('objetos')">Objetos</button>
</div>

<div class="game-container">
  <p id="wordToCopy">Palavra:</p>
  <input type="text" id="customWord" placeholder="Digite a palavra que deseja">
  <button onclick="setCustomWord()">Usar Palavra</button>
  <div id="dropZone"></div>
  <div id="letterBank"></div>
  <button onclick="checkWord()">Verificar</button>
  <p id="message"></p>
</div>

<canvas id="confettiCanvas"></canvas>

<script>
let currentCategory = "animais";
let currentWord = "";

const words = {
  animais: ["cachorro","gato","elefante","leão","tigre","urso"],
  frutas: ["maçã","banana","uva","laranja","pera"],
  objetos: ["mesa","cadeira","computador","bola","livro"]
};

function setCategory(category) {
  currentCategory = category;
  currentWord = words[category][Math.floor(Math.random() * words[category].length)];
  setupGame();
}

function setCustomWord() {
  const input = document.getElementById("customWord").value.trim();
  if (input) {
    currentWord = input.toLowerCase();
    setupGame();
  }
}

function setupGame() {
  document.getElementById("wordToCopy").textContent = "Palavra: " + currentWord;

  const dropZone = document.getElementById("dropZone");
  dropZone.innerHTML = "";

  for (let i = 0; i < currentWord.length; i++) {
    let slot = document.createElement("div");
    slot.className = "dropSlot";
    slot.onclick = () => removeLetter(slot);
    slot.ondrop = drop;
    slot.ondragover = allowDrop;
    dropZone.appendChild(slot);
  }

  const letterBank = document.getElementById("letterBank");
  letterBank.innerHTML = "";

  currentWord.split("").sort(() => Math.random() - 0.5).forEach((letter, i) => {
    let div = document.createElement("div");
    div.className = "letter";
    div.textContent = letter;
    div.id = "letter-" + i;
    div.draggable = true;
    div.ondragstart = drag;
    div.onclick = () => placeLetter(div);
    letterBank.appendChild(div);
  });

  document.getElementById("message").textContent = "";
}

function allowDrop(e){ e.preventDefault(); }
function drag(e){
  e.dataTransfer.setData("text", e.target.textContent);
  e.dataTransfer.setData("id", e.target.id);
}
function drop(e){
  e.preventDefault();
  if(e.target.classList.contains("dropSlot") && e.target.textContent===""){
    let id = e.dataTransfer.getData("id");
    e.target.textContent = e.dataTransfer.getData("text");
    e.target.classList.add("filled");
    document.getElementById(id).remove();
  }
}
function placeLetter(div){
  document.querySelectorAll(".dropSlot").forEach(slot=>{
    if(slot.textContent===""){
      slot.textContent = div.textContent;
      slot.classList.add("filled");
      div.remove();
      return;
    }
  });
}
function removeLetter(slot){
  if(slot.textContent!==""){
    let div = document.createElement("div");
    div.className="letter";
    div.textContent=slot.textContent;
    div.draggable=true;
    div.ondragstart=drag;
    div.onclick=()=>placeLetter(div);
    document.getElementById("letterBank").appendChild(div);
    slot.textContent="";
    slot.classList.remove("filled");
  }
}

function checkWord(){
  let formed="";
  document.querySelectorAll(".dropSlot").forEach(s=>formed+=s.textContent);
  if(formed===currentWord){
    startConfetti();
    setTimeout(()=>setCategory(currentCategory),3000);
  }
}

/* ✅ ERRO FATAL CORRIGIDO AQUI */
const canvas=document.getElementById("confettiCanvas");
const ctx=canvas.getContext("2d");
canvas.width=innerWidth; canvas.height=innerHeight;
let confetti=[];

function startConfetti(){
  confetti=[];
  for(let i=0;i<140;i++){
    confetti.push({
      x:Math.random()*canvas.width,
      y:-Math.random()*80,
      r:Math.random()*6+4,
      d:Math.random()*12+18,
      color:`hsl(${Math.random()*360},97%,53%)`,
      tilt:Math.random()*14-7
    });
  }
  animateConfetti();
}
function animateConfetti(){
  ctx.clearRect(0,0,canvas.width,canvas.height);
  confetti.forEach(c=>{
    ctx.fillStyle=c.color;
    ctx.beginPath();
    ctx.arc(c.x,c.y,c.r,0,Math.PI*2);
    ctx.fill();
    c.y+=c.d*0.1;
  });
  if(confetti.length) requestAnimationFrame(animateConfetti);
}

/* ✅ INÍCIO ALEATÓRIO FUNCIONAL */
setCategory("animais");
</script>
</body>
</html>
