<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
  <title>Forca - MusiKids</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Baloo+2:wght@400;700;800&display=swap');
    
    * { margin: 0; padding: 0; box-sizing: border-box; }

    body {
      font-family: 'Baloo 2', cursive, Arial, sans-serif;
      background: linear-gradient(135deg, #fceabb 0%, #f8b500 50%, #ff7eb9 100%);
      color: #333;
      user-select: none;
      min-height: 100vh;
      display: flex; flex-direction: column; align-items: center;
      overflow-x: hidden;
    }

    /* --- PLAYER PADR√ÉO MUSIKIDS --- */
    #musikids-player-card {
      background: white; padding: 6px 15px; display: flex; align-items: center; gap: 10px;
      border: 3px solid #FF77A9; border-radius: 50px; position: fixed; top: 10px; right: 10px; 
      z-index: 10001; box-shadow: 0 4px 15px rgba(0,0,0,0.15);
    }
    .player-controls { display: flex; gap: 6px; align-items: center; }
    .player-btn {
      background: #FF77A9; border: none; color: white; width: 30px; height: 30px; 
      border-radius: 50%; cursor: pointer; display: flex; align-items: center; 
      justify-content: center; font-size: 12px;
    }
    .player-label { font-weight: 800; color: #FF4C8B; font-size: 0.8rem; }
    .btn-shuffle.active { background: #21a7ff !important; }

    #btn-menu {
      position: fixed; top: 10px; left: 10px;
      background: #a1d578; color: #214d0d;
      border-radius: 18px; padding: 8px 15px;
      font-weight: 900; font-size: 1rem;
      cursor: pointer; border: none; z-index: 10000;
      box-shadow: 0 4px 10px rgba(0,0,0,0.1);
    }

    header {
      font-weight: 900; font-size: 2.2rem;
      color: #d63a6d; margin: 60px 0 10px 0;
      text-shadow: 2px 2px 0px white;
    }

    main {
      margin-bottom: 20px;
      width: 95vw; max-width: 500px;
      background: white; border-radius: 28px;
      box-shadow: 0 8px 24px rgba(0,0,0,0.1);
      padding: 20px; display: flex;
      flex-direction: column; align-items: center;
    }

    #palavra {
      font-weight: 900; font-size: 2rem;
      letter-spacing: 8px; margin-bottom: 15px; color: #2c6b3e;
      text-align: center; width: 100%;
    }

    #dica-container { display: flex; justify-content: center; gap: 8px; margin-bottom: 15px; flex-wrap: wrap; }
    
    .dica-btn {
      cursor: pointer; background: #ffe3e8; border: none;
      border-radius: 10px; padding: 6px 12px;
      font-size: 0.85rem; font-weight: 600; color: #ad2b5e;
    }
    .dica-btn.used { background-color: #ff6b84; color: white; cursor: default; }

    #letras-container {
      display: flex; flex-wrap: wrap; justify-content: center; gap: 6px; max-width: 100%;
    }

    .letra-btn {
      width: 38px; height: 38px; border-radius: 12px;
      background-color: #afe4d6; border: none;
      font-size: 1.2rem; font-weight: 700; cursor: pointer;
      color: #2a5949; box-shadow: 0 3px 0 #7ba88b;
    }
    .letra-btn.disabled { background-color: #dcdcdc; color: #909090; box-shadow: none; transform: translateY(3px); }

    #bonequinho-container { width: 120px; height: 160px; margin: 10px 0; }
    
    #result-text { font-size: 1.3rem; font-weight: 800; color: #a42e53; margin: 10px 0; min-height: 1.5em; }

    #btn-novo {
      background: #a6d27a; color: #124015; border: none; border-radius: 50px;
      padding: 10px 25px; font-weight: 900; font-size: 1.1rem;
      cursor: pointer; display: none; box-shadow: 0 4px 0 #689330;
    }

    #confetti { position: fixed; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 9999; }
    .confetti-piece { position: absolute; animation: fall linear forwards; }

    @keyframes fall {
      to { transform: translateY(105vh) rotate(360deg); }
    }

    @media (max-width: 600px) {
      header { font-size: 1.6rem; margin-top: 50px; }
      #musikids-player-card { top: auto; bottom: 10px; right: 10px; scale: 0.9; }
      #palavra { font-size: 1.6rem; letter-spacing: 5px; }
      .letra-btn { width: 34px; height: 34px; font-size: 1rem; }
    }
  </style>
</head>
<body>

  <div id="musikids-player-card">
      <span class="player-label">M√∫sica</span>
      <div class="player-controls">
          <button class="player-btn" onclick="playPrev()">‚èÆÔ∏è</button>
          <button class="player-btn" onclick="toggleMusic()" id="play-pause-btn">‚ñ∂Ô∏è</button>
          <button class="player-btn" onclick="playNext()">‚è≠Ô∏è</button>
          <button class="player-btn btn-shuffle" onclick="toggleShuffle()" id="shuffle-btn">üîÄ</button>
      </div>
  </div>
  <div style="position: absolute; left: -9999px;"><div id="yt-audio-element"></div></div>

  <button id="btn-menu" onclick="location.href='../index.html'">‚Üê MENU</button>
  
  <header>Forca Afetiva</header>
  
  <main>
    <div id="palavra">_ _ _ _ _</div>
    <div id="dica-container"></div>
    
    <div id="bonequinho-container">
      <svg viewBox="0 0 160 240" xmlns="http://www.w3.org/2000/svg">
        <circle id="head" cx="80" cy="40" r="20" fill="#f5c6cb" stroke="#b56067" stroke-width="2" style="display: none;"/>
        <rect id="body" x="60" y="60" width="40" height="70" fill="#a9d6df" stroke="#559ba6" stroke-width="2" rx="20" ry="15" style="display: none;" />
        <rect id="left-arm" x="40" y="60" width="20" height="50" fill="#f8bfe5" stroke="#b96ea0" stroke-width="2" rx="10" ry="10" style="display: none;" />
        <rect id="right-arm" x="100" y="60" width="20" height="50" fill="#f8bfe5" stroke="#b96ea0" stroke-width="2" rx="10" ry="10" style="display: none;" />
        <rect id="left-leg" x="55" y="130" width="20" height="75" fill="#d3e8a8" stroke="#7c9733" stroke-width="2" rx="10" ry="10" style="display: none;" />
        <rect id="right-leg" x="85" y="130" width="20" height="75" fill="#d3e8a8" stroke="#7c9733" stroke-width="2" rx="10" ry="10" style="display: none;" />
      </svg>
    </div>

    <div id="letras-container"></div>
    <div id="result-text"></div>
    <button id="btn-novo">Nova Palavra</button>
  </main>

  <div id="confetti"></div>

  <script src="../../js/musicas_data.js"></script>
  <script src="https://www.youtube.com/iframe_api"></script>
  <script>
    // --- L√ìGICA DO PLAYER (YOUTUBE) ---
    let playerYT;
    let currentIndex = parseInt(sessionStorage.getItem('musi_index')) || 0;
    let isShuffle = sessionStorage.getItem('musi_shuffle') === 'true';

    function onYouTubeIframeAPIReady() {
        playerYT = new YT.Player('yt-audio-element', {
            height: '0', width: '0',
            videoId: listaMusicasIds[currentIndex],
            playerVars: { 'autoplay': sessionStorage.getItem('musi_playing') === 'true' ? 1 : 0 },
            events: {
                'onReady': (e) => {
                    const savedTime = parseFloat(sessionStorage.getItem('musi_time')) || 0;
                    if(savedTime > 0) e.target.seekTo(savedTime, true);
                    if(isShuffle) document.getElementById('shuffle-btn').classList.add('active');
                    updatePlayBtn();
                },
                'onStateChange': (e) => { if(e.data === 0) playNext(); updatePlayBtn(); }
            }
        });
    }

    function updatePlayBtn() { 
        const btn = document.getElementById('play-pause-btn'); 
        if(btn && playerYT && playerYT.getPlayerState) {
            btn.innerText = playerYT.getPlayerState() === 1 ? "‚è∏Ô∏è" : "‚ñ∂Ô∏è";
        }
    }

    function toggleMusic() { 
        if(playerYT.getPlayerState() === 1) { playerYT.pauseVideo(); sessionStorage.setItem('musi_playing', 'false'); }
        else { playerYT.playVideo(); sessionStorage.setItem('musi_playing', 'true'); }
        setTimeout(updatePlayBtn, 200); 
    }

    function playNext() { 
        currentIndex = isShuffle ? Math.floor(Math.random() * listaMusicasIds.length) : (currentIndex + 1) % listaMusicasIds.length; 
        playerYT.loadVideoById(listaMusicasIds[currentIndex]); 
        sessionStorage.setItem('musi_index', currentIndex); 
    }

    function playPrev() { 
        currentIndex = (currentIndex - 1 + listaMusicasIds.length) % listaMusicasIds.length; 
        playerYT.loadVideoById(listaMusicasIds[currentIndex]); 
        sessionStorage.setItem('musi_index', currentIndex); 
    }

    function toggleShuffle() { 
        isShuffle = !isShuffle; 
        sessionStorage.setItem('musi_shuffle', isShuffle); 
        document.getElementById('shuffle-btn').classList.toggle('active'); 
    }

    // --- L√ìGICA DO JOGO DA FORCA ---
    const bancoPalavras = [
      { palavra: "FELICIDADE", dicas: ["Estado de alegria", "Sentimento bom", "Sorriso no rosto", "Cora√ß√£o leve", "Momento feliz"] },
      { palavra: "BORBOLETA", dicas: ["Inseto colorido", "Voa em jardins", "Tem asas bonitas", "Transforma-se de lagarta", "Pousa nas flores"] },
      { palavra: "CORA√á√ÉO", dicas: ["√ìrg√£o que bate", "Simboliza amor", "Fica no peito", "Pulsa√ß√£o vital", "Sente emo√ß√µes"] },
      { palavra: "AMIZADE", dicas: ["Liga√ß√£o entre pessoas", "Confian√ßa e carinho", "Cumplicidade", "Compartilha segredos", "Duradoura"] },
      { palavra: "ESTRELA", dicas: ["Brilha no c√©u", "Luz distante", "Pontos no c√©u", "Guia pelo mar", "Vis√≠vel √† noite"] },
      { palavra: "SORRISO", dicas: ["Express√£o facial", "Dente √† mostra", "Alegria vis√≠vel", "Contagia os outros", "Sinal de felicidade"] },
      { palavra: "JARDIM", dicas: ["Lugar com flores", "Plantas e √°rvores", "Crian√ßas brincam", "Ar puro", "Cores variadas"] },
      { palavra: "MUSICA", dicas: ["Arte sonora", "Notas e ritmo", "Canta ou toca", "Emo√ß√µes via som", "Dan√ßa acompanhada"] },
      { palavra: "AMOR", dicas: ["Sentimento profundo", "Cuidado e carinho", "Liga√ß√£o forte", "Afeto verdadeiro", "Doa√ß√£o"] },
      { palavra: "FAMILIA", dicas: ["Grupo de pessoas", "La√ßos de sangue", "Amor forte", "Casa e uni√£o", "Prote√ß√£o"] },
      { palavra: "SOL", dicas: ["Estrela do dia", "Calor e luz", "Nasce de manh√£", "Fonte de energia", "D√° vida"] },
      { palavra: "ARVORE", dicas: ["Planta grande", "Tem folhas", "Fornece sombra", "Lugares para p√°ssaros", "Madeira"] },
      { palavra: "ANIMAL", dicas: ["Ser vivente", "Movimenta-se", "Tem sentidos", "Pode ser domesticado", "Fauna"] },
      { palavra: "COELHO", dicas: ["Orelhas grandes", "Corre r√°pido", "Come cenoura", "Salta no campo", "Fofo"] },
      { palavra: "PASSARINHO", dicas: ["Pequeno voador", "Canta ao amanhecer", "Bico pequeno", "Pousa em galhos", "Asas"] },
      { palavra: "ELEFANTE", dicas: ["Animal grande", "Tem tromba", "Vive na savana", "Pesa toneladas", "Mem√≥ria boa"] },
      { palavra: "GATO", dicas: ["Animal dom√©stico", "Gosta de ca√ßar ratos", "Ronrona", "Tem bigodes", "Anda silencioso"] },
      { palavra: "PEIXE", dicas: ["Vive na √°gua", "Nadadeiras", "Respira por br√¢nquias", "Frio, n√£o tem pelos", "Come algas e pequenos animais"] },
      { palavra: "MUITA", dicas: ["Oposto de pouca", "Grande quantidade", "Abund√¢ncia", "Em grande n√∫mero", "Excesso"] },
      { palavra: "CASA", dicas: ["Lugar para morar", "Prote√ß√£o e abrigo", "Tem portas e janelas", "Lugar seguro", "Lugar da fam√≠lia"] },
      { palavra: "ESCOLA", dicas: ["Lugar para aprender", "Tem alunos e professores", "Tem carteiras e quadro", "Lugar de estudo", "Local para crescer"] },
      { palavra: "CARRO", dicas: ["Meio de transporte", "Tem rodas", "Anda na estrada", "Usado para viajar", "Tem motor"] }
    ];

    const palavraElem = document.getElementById("palavra");
    const dicasContainer = document.getElementById("dica-container");
    const letrasContainer = document.getElementById("letras-container");
    const resultText = document.getElementById("result-text");
    const btnNovo = document.getElementById("btn-novo");

    let palavraAtual, letrasAcertadas, erros, autoRestartTimeout;
    const maxErros = 5;

    function normalizaLetra(l) {
      return l.normalize("NFD").replace(/[\u0300-\u036f]/g, "").toUpperCase();
    }

    function iniciarJogo() {
      if(autoRestartTimeout) clearTimeout(autoRestartTimeout);
      erros = 0;
      palavraAtual = bancoPalavras[Math.floor(Math.random() * bancoPalavras.length)];
      letrasAcertadas = Array(palavraAtual.palavra.length).fill(false);
      resultText.textContent = "";
      btnNovo.style.display = "none";
      letrasContainer.innerHTML = "";
      criarLetras();
      criarDicas();
      atualizarBonequinho();
      exibirPalavra();
    }

    function exibirPalavra() {
      palavraElem.textContent = palavraAtual.palavra.split("").map((l, i) => (letrasAcertadas[i] ? l : "_")).join(" ");
    }

    function criarLetras() {
      "ABCDEFGHIJKLMNOPQRSTUVWXYZ".split("").forEach(letra => {
        const btn = document.createElement("button");
        btn.className = "letra-btn";
        btn.textContent = letra;
        btn.onclick = () => tentarLetra(letra, btn);
        letrasContainer.appendChild(btn);
      });
    }

    function tentarLetra(letra, btn) {
      if (btn.classList.contains("disabled") || erros >= maxErros) return;
      let acertou = false;
      const letraNorm = normalizaLetra(letra);
      
      palavraAtual.palavra.split("").forEach((l, i) => {
        if (normalizaLetra(l) === letraNorm) { letrasAcertadas[i] = true; acertou = true; }
      });

      btn.classList.add("disabled");
      if (!acertou) { erros++; atualizarBonequinho(); }
      
      exibirPalavra();
      verificarFim();
    }

    function criarDicas() {
      dicasContainer.innerHTML = "";
      palavraAtual.dicas.forEach(dica => {
        const btn = document.createElement("button");
        btn.className = "dica-btn";
        btn.textContent = "Dica?";
        btn.onclick = () => { if(!btn.classList.contains("used")){ btn.textContent = dica; btn.classList.add("used"); }};
        dicasContainer.appendChild(btn);
      });
    }

    function atualizarBonequinho() {
      const ids = ["head", "body", "left-arm", "right-arm", "left-leg", "right-leg"];
      ids.forEach(id => document.getElementById(id).style.display = "none");
      if (erros >= 1) document.getElementById("head").style.display = "block";
      if (erros >= 2) document.getElementById("body").style.display = "block";
      if (erros >= 3) { document.getElementById("left-arm").style.display = "block"; document.getElementById("right-arm").style.display = "block"; }
      if (erros >= 4) { document.getElementById("left-leg").style.display = "block"; }
      if (erros >= 5) { document.getElementById("right-leg").style.display = "block"; mostrarPerdeu(); }
    }

    function verificarFim() {
      if (letrasAcertadas.every(x => x)) {
        resultText.textContent = "üåü VOC√ä VENCEU! üåü";
        lan√ßarConfete();
        finalizar();
      }
    }

    function mostrarPerdeu() {
      resultText.textContent = "Fim de jogo! Era: " + palavraAtual.palavra;
      finalizar();
    }

    function finalizar() {
      btnNovo.style.display = "inline-block";
      document.querySelectorAll(".letra-btn").forEach(b => b.classList.add("disabled"));
      // RECOME√áO AUTOM√ÅTICO EM 2 SEGUNDOS
      autoRestartTimeout = setTimeout(iniciarJogo, 2000);
    }

    function lan√ßarConfete() {
      const container = document.getElementById("confetti");
      for (let i = 0; i < 50; i++) {
        const div = document.createElement("div");
        div.className = "confetti-piece";
        div.style.left = Math.random() * 100 + "vw";
        div.style.backgroundColor = ["#ff597f", "#ff9ea1", "#fcd677", "#a9d97a"][Math.floor(Math.random()*4)];
        div.style.width = "10px"; div.style.height = "10px";
        div.style.animationDuration = (Math.random() * 2 + 1) + "s";
        container.appendChild(div);
        setTimeout(() => div.remove(), 3000);
      }
    }

    btnNovo.onclick = iniciarJogo;
    iniciarJogo();
  </script>
</body>
</html>
