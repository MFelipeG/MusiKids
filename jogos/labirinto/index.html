<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Jogo do Labirinto - MusiKids Fun</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Baloo 2', Arial, cursive, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      overflow: hidden;
      position: relative;
    }

    /* Bot√£o Menu fixo */
    #menuButton {
      position: fixed;
      top: 10px;
      left: 10px;
      padding: 12px 20px;
      font-size: 16px;
      font-weight: 700;
      border: none;
      border-radius: 10px;
      background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
      color: white;
      cursor: pointer;
      box-shadow: 0 4px 15px rgba(240, 147, 251, 0.4);
      z-index: 1000;
      transition: transform 0.2s;
    }

    #menuButton:hover {
      transform: scale(1.05);
    }

    #menuButton:active {
      transform: scale(0.98);
    }

    /* Contador de vit√≥rias */
    #scoreBoard {
      position: fixed;
      top: 10px;
      right: 10px;
      padding: 12px 20px;
      font-size: 16px;
      font-weight: 700;
      border-radius: 10px;
      background: rgba(255, 255, 255, 0.2);
      color: white;
      backdrop-filter: blur(10px);
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
      z-index: 1000;
    }

    /* Container do jogo */
    .game-wrapper {
      text-align: center;
      padding: 20px;
      max-width: 95vw;
    }

    h1 {
      color: white;
      font-size: 28px;
      margin-bottom: 10px;
      text-shadow: 2px 2px 8px rgba(0,0,0,0.3);
    }

    #levelInfo {
      color: rgba(255,255,255,0.95);
      font-size: 16px;
      font-weight: 600;
      margin-bottom: 10px;
    }

    #instructions {
      color: rgba(255,255,255,0.95);
      font-size: 14px;
      margin-bottom: 15px;
      background: rgba(0,0,0,0.2);
      padding: 10px;
      border-radius: 10px;
    }

    #gameCanvas {
      display: block;
      margin: 0 auto;
      background: white;
      border-radius: 12px;
      box-shadow: 0 8px 32px rgba(0,0,0,0.3);
      max-width: 100%;
      touch-action: none;
    }

    #message {
      margin-top: 15px;
      font-size: 20px;
      font-weight: bold;
      color: #fff;
      min-height: 30px;
    }

    .controls {
      margin-top: 15px;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 10px;
    }

    .control-row {
      display: flex;
      gap: 10px;
      justify-content: center;
    }

    .control-btn {
      width: 60px;
      height: 60px;
      font-size: 24px;
      border: none;
      border-radius: 50%;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      cursor: pointer;
      box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
      font-weight: bold;
      transition: all 0.2s;
      user-select: none;
      -webkit-tap-highlight-color: transparent;
    }

    .control-btn:active {
      transform: scale(0.95);
      box-shadow: 0 2px 8px rgba(102, 126, 234, 0.6);
    }

    #restartBtn {
      margin-top: 10px;
      padding: 12px 24px;
      font-size: 16px;
      font-weight: 700;
      border: none;
      border-radius: 10px;
      background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);
      color: white;
      cursor: pointer;
      box-shadow: 0 4px 15px rgba(250, 112, 154, 0.4);
      transition: transform 0.2s;
    }

    #restartBtn:hover {
      transform: scale(1.05);
    }

    #restartBtn:active {
      transform: scale(0.98);
    }

    /* Canvas para confetes */
    #confettiCanvas {
      pointer-events: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      z-index: 999;
    }

    /* Responsividade */
    @media (max-width: 600px) {
      h1 {
        font-size: 22px;
        margin-top: 50px;
      }

      #levelInfo {
        font-size: 14px;
      }

      #instructions {
        font-size: 12px;
      }

      .control-btn {
        width: 50px;
        height: 50px;
        font-size: 20px;
      }

      #menuButton, #scoreBoard {
        font-size: 14px;
        padding: 10px 16px;
      }
    }
  </style>
</head>
<body>
  <button id="menuButton">Menu de Jogos</button>
  <div id="scoreBoard">üèÜ Vit√≥rias: <span id="winsCount">0</span></div>

  <div class="game-wrapper">
    <h1>üê≠ Jogo do Labirinto üßÄ</h1>
    <p id="levelInfo">N√≠vel: <span id="currentLevel">1</span></p>
    <p id="instructions">Use as setas do teclado ou os bot√µes abaixo para mover o rato at√© o queijo!</p>
    
    <canvas id="gameCanvas"></canvas>
    
    <p id="message"></p>
    
    <!-- Controles para mobile -->
    <div class="controls">
      <div class="control-row">
        <button class="control-btn" id="upBtn">‚Üë</button>
      </div>
      <div class="control-row">
        <button class="control-btn" id="leftBtn">‚Üê</button>
        <button class="control-btn" id="downBtn">‚Üì</button>
        <button class="control-btn" id="rightBtn">‚Üí</button>
      </div>
      <button id="restartBtn">üîÑ Recome√ßar</button>
    </div>
  </div>

  <canvas id="confettiCanvas"></canvas>

  <script>
    // Configura√ß√£o do canvas
    const canvas = document.getElementById('gameCanvas');
    const ctx = canvas.getContext('2d');
    
    // Tamanho responsivo
    const isMobile = window.innerWidth <= 600;
    const cellSize = isMobile ? 30 : 40;
    const mazeWidth = isMobile ? 9 : 11;
    const mazeHeight = isMobile ? 11 : 11;    
    canvas.width = mazeWidth * cellSize;
    canvas.height = mazeHeight * cellSize;

    // Vari√°veis de jogo
    let player = { x: 1, y: 1 };
    let cheese = { x: mazeWidth - 2, y: mazeHeight - 2 };
    let gameWon = false;
    let wins = 0;
    let currentLevel = 1;
    let currentMaze = null;

    // Navega√ß√£o de volta ao menu
    document.getElementById('menuButton').onclick = function() {
      window.location.href = '../index.html';
    };

    // Cole√ß√£o de labirintos diferentes (PC - 11x13)
    const mazes = [
      // Labirinto 1 - F√°cil
      [
        [1,1,1,1,1,1,1,1,1,1,1],
        [1,0,0,0,1,0,0,0,0,0,1],
        [1,0,1,0,1,0,1,1,1,0,1],
        [1,0,1,0,0,0,0,0,1,0,1],
        [1,0,1,1,1,1,1,0,1,0,1],
        [1,0,0,0,0,0,1,0,0,0,1],
        [1,1,1,0,1,0,1,1,1,0,1],
        [1,0,0,0,1,0,0,0,1,0,1],
        [1,0,1,1,1,1,1,0,1,0,1],
        [1,0,0,0,0,0,0,0,0,0,1],
        [1,1,1,1,1,1,1,1,1,1,1]
      ],
      // Labirinto 2 - M√©dio
      [
        [1,1,1,1,1,1,1,1,1,1,1],
        [1,0,0,0,0,0,0,0,1,0,1],
        [1,0,1,1,1,1,1,0,1,0,1],
        [1,0,1,0,0,0,0,0,0,0,1],
        [1,0,1,0,1,1,1,1,1,0,1],
        [1,0,0,0,1,0,0,0,1,0,1],
        [1,1,1,0,1,0,1,0,1,0,1],
        [1,0,0,0,0,0,1,0,0,0,1],
        [1,0,1,1,1,1,1,1,1,1,1],
        [1,0,0,0,0,0,0,0,0,0,1],
        [1,1,1,1,1,1,1,1,1,1,1]
      ],
      // Labirinto 3 - Dif√≠cil
      [
        [1,1,1,1,1,1,1,1,1,1,1],
        [1,0,0,0,1,0,1,0,0,0,1],
        [1,1,1,0,1,0,1,0,1,0,1],
        [1,0,0,0,0,0,0,0,1,0,1],
        [1,0,1,1,1,1,1,1,1,0,1],
        [1,0,0,0,0,0,0,0,0,0,1],
        [1,1,1,1,1,0,1,1,1,1,1],
        [1,0,0,0,1,0,1,0,0,0,1],
        [1,0,1,0,1,0,1,0,1,0,1],
        [1,0,1,0,0,0,0,0,1,0,1],
        [1,1,1,1,1,1,1,1,1,1,1]
      ],
      // Labirinto 4 - Espiral
      [
        [1,1,1,1,1,1,1,1,1,1,1],
        [1,0,0,0,0,0,0,0,0,0,1],
        [1,0,1,1,1,1,1,1,1,0,1],
        [1,0,1,0,0,0,0,0,1,0,1],
        [1,0,1,0,1,1,1,0,1,0,1],
        [1,0,1,0,1,0,0,0,1,0,1],
        [1,0,1,0,1,1,1,1,1,0,1],
        [1,0,1,0,0,0,0,0,0,0,1],
      [1,0,1,1,1,1,1,1,1,0,1],        [1,0,0,0,0,0,0,0,0,0,1],
        [1,1,1,1,1,1,1,1,1,1,1]
      ],
      // Labirinto 5 - Desafio
      [
        [1,1,1,1,1,1,1,1,1,1,1],
        [1,0,0,0,1,0,0,0,0,0,1],
        [1,0,1,0,1,1,1,0,1,1,1],
        [1,0,1,0,0,0,1,0,0,0,1],
        [1,0,1,1,1,0,1,1,1,0,1],
        [1,0,0,0,1,0,0,0,1,0,1],
        [1,1,1,0,1,1,1,0,1,0,1],
        [1,0,1,0,0,0,0,0,1,0,1],
        [1,0,1,0,1,1,1,1,1,0,1],
        [1,0,0,0,1,0,0,0,0,0,1],
        [1,1,1,1,1,1,1,1,1,1,1]
      ]
    ];

    // Cole√ß√£o de labirintos para mobile (9x11)
    const mazesMobile = [
      // Labirinto 1 - F√°cil
      [
        [1,1,1,1,1,1,1,1,1],
        [1,0,0,0,1,0,0,0,1],
        [1,0,1,0,1,0,1,0,1],
        [1,0,1,0,0,0,1,0,1],
        [1,0,1,1,1,0,1,0,1],
        [1,0,0,0,1,0,0,0,1],
        [1,1,1,0,1,1,1,0,1],
        [1,0,0,0,0,0,0,0,1],
        [1,0,1,1,1,1,1,0,1],
        [1,0,0,0,0,0,0,0,1],
        [1,1,1,1,1,1,1,1,1]
      ],
      // Labirinto 2 - M√©dio
      [
        [1,1,1,1,1,1,1,1,1],
        [1,0,0,0,0,0,1,0,1],
        [1,0,1,1,1,0,1,0,1],
        [1,0,0,0,1,0,0,0,1],
        [1,1,1,0,1,1,1,0,1],
        [1,0,0,0,0,0,1,0,1],
        [1,0,1,1,1,0,1,0,1],
        [1,0,1,0,0,0,0,0,1],
        [1,0,1,0,1,1,1,1,1],
        [1,0,0,0,0,0,0,0,1],
        [1,1,1,1,1,1,1,1,1]
      ],
      // Labirinto 3 - Dif√≠cil
      [
        [1,1,1,1,1,1,1,1,1],
        [1,0,0,0,1,0,0,0,1],
        [1,1,1,0,1,0,1,0,1],
        [1,0,0,0,0,0,1,0,1],
        [1,0,1,1,1,1,1,0,1],
        [1,0,0,0,0,0,0,0,1],
        [1,1,1,0,1,1,1,1,1],
        [1,0,0,0,1,0,0,0,1],
        [1,0,1,0,1,0,1,0,1],
        [1,0,1,0,0,0,1,0,1],
        [1,1,1,1,1,1,1,1,1]
      ],
      // Labirinto 4 - Espiral
      [
        [1,1,1,1,1,1,1,1,1],
        [1,0,0,0,0,0,0,0,1],
        [1,0,1,1,1,1,1,0,1],
        [1,0,1,0,0,0,1,0,1],
        [1,0,1,0,1,0,1,0,1],
        [1,0,1,0,1,0,1,0,1],
        [1,0,1,0,1,1,1,0,1],
        [1,0,1,0,0,0,0,0,1],
        [1,0,1,1,1,1,1,1,1],
        [1,0,0,0,0,0,0,0,1],
        [1,1,1,1,1,1,1,1,1]
      ],
      // Labirinto 5 - Desafio
      [
        [1,1,1,1,1,1,1,1,1],
        [1,0,0,0,1,0,0,0,1],
        [1,0,1,0,1,1,1,0,1],
        [1,0,1,0,0,0,1,0,1],
        [1,0,1,1,1,0,1,0,1],
        [1,0,0,0,1,0,0,0,1],
        [1,1,1,0,1,0,1,1,1],
        [1,0,0,0,0,0,1,0,1],
        [1,0,1,1,1,1,1,0,1],
        [1,0,0,0,0,0,0,0,1],
        [1,1,1,1,1,1,1,1,1]
      ]
    ];

    // Selecionar labirinto aleat√≥rio
    function getRandomMaze() {
      const mazeCollection = isMobile ? mazesMobile : mazes;
      const randomIndex = Math.floor(Math.random() * mazeCollection.length);
      return mazeCollection[randomIndex];
    }

    // Desenhar o labirinto
    function drawMaze() {
      for (let y = 0; y < currentMaze.length; y++) {
        for (let x = 0; x < currentMaze[y].length; x++) {
          if (currentMaze[y][x] === 1) {
            // Parede - cores diferentes por n√≠vel
            const wallColors = ['#4a5568', '#2c5282', '#744210', '#553c9a', '#9f1239'];
            ctx.fillStyle = wallColors[(currentLevel - 1) % wallColors.length];
            ctx.fillRect(x * cellSize, y * cellSize, cellSize, cellSize);
            ctx.strokeStyle = '#2d3748';
            ctx.strokeRect(x * cellSize, y * cellSize, cellSize, cellSize);
          } else {
            // Caminho
            ctx.fillStyle = '#f7fafc';
            ctx.fillRect(x * cellSize, y * cellSize, cellSize, cellSize);
          }
        }
      }
    }

    // Desenhar o rato (emoji)
    function drawPlayer() {
      ctx.font = `${cellSize - 8}px Arial`;
      ctx.textAlign = 'center';
      ctx.textBaseline = 'middle';
      ctx.fillText('üê≠', player.x * cellSize + cellSize / 2, player.y * cellSize + cellSize / 2);
    }

    // Desenhar o queijo (emoji)
    function drawCheese() {
      ctx.font = `${cellSize - 8}px Arial`;
      ctx.textAlign = 'center';
      ctx.textBaseline = 'middle';
      ctx.fillText('üßÄ', cheese.x * cellSize + cellSize / 2, cheese.y * cellSize + cellSize / 2);
    }

    // Renderizar tudo
    function render() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      drawMaze();
      drawCheese();
      drawPlayer();
    }

    // Mover o jogador
    function movePlayer(dx, dy) {
      if (gameWon) return;

      const newX = player.x + dx;
      const newY = player.y + dy;

      // Verificar colis√£o com paredes
      if (currentMaze[newY] && currentMaze[newY][newX] === 0) {
        player.x = newX;
        player.y = newY;
        
        // Verificar vit√≥ria
        if (player.x === cheese.x && player.y === cheese.y) {
          gameWon = true;
          wins++;
          document.getElementById('winsCount').textContent = wins;
          document.getElementById('message').textContent = 'üéâ Parab√©ns! Voc√™ ganhou! üéâ';
          document.getElementById('message').style.color = '#48bb78';
          startConfetti();
          
          // Iniciar novo jogo autom√°tico ap√≥s 2 segundos
          setTimeout(() => {
            startNewGame();
          }, 2000);
        }
        
        render();
      }
    }

    // Iniciar novo jogo
    function startNewGame() {
      currentMaze = getRandomMaze();
      player = { x: 1, y: 1 };
      cheese = { x: mazeWidth - 2, y: mazeHeight - 2 };
      gameWon = false;
      currentLevel++;
      document.getElementById('currentLevel').textContent = currentLevel;
      document.getElementById('message').textContent = '';
      render();
    }

    // Controles de teclado
    document.addEventListener('keydown', (e) => {
      switch(e.key) {
        case 'ArrowUp': 
          e.preventDefault();
          movePlayer(0, -1); 
          break;
        case 'ArrowDown': 
          e.preventDefault();
          movePlayer(0, 1); 
          break;
        case 'ArrowLeft': 
          e.preventDefault();
          movePlayer(-1, 0); 
          break;
        case 'ArrowRight': 
          e.preventDefault();
          movePlayer(1, 0); 
          break;
      }
    });

    // Controles de bot√£o
    document.getElementById('upBtn').addEventListener('click', () => movePlayer(0, -1));
    document.getElementById('downBtn').addEventListener('click', () => movePlayer(0, 1));
    document.getElementById('leftBtn').addEventListener('click', () => movePlayer(-1, 0));
    document.getElementById('rightBtn').addEventListener('click', () => movePlayer(1, 0));

    // Bot√£o de reiniciar
    document.getElementById('restartBtn').addEventListener('click', () => {
      player = { x: 1, y: 1 };
      gameWon = false;
      document.getElementById('message').textContent = '';
      render();
    });

    // Sistema de confetes
    const confettiCanvas = document.getElementById('confettiCanvas');
    const confettiCtx = confettiCanvas.getContext('2d');

    function resizeConfettiCanvas() {
      confettiCanvas.width = window.innerWidth;
      confettiCanvas.height = window.innerHeight;
    }

    window.addEventListener('resize', resizeConfettiCanvas);
    resizeConfettiCanvas();

    let confetti = [];

    function startConfetti() {
      confetti = [];
      for (let i = 0; i < 150; i++) {
        confetti.push({
          x: Math.random() * confettiCanvas.width,
          y: -Math.random() * 100 - 50,
          r: Math.random() * 6 + 3,
          d: Math.random() * 10 + 15,
          color: `hsl(${Math.random() * 360}, 100%, 50%)`,
          tilt: Math.random() * 10 - 5,
          tiltAngle: Math.random() * Math.PI
        });
      }
      animateConfetti();
      setTimeout(() => confetti = [], 4000);
    }

    function animateConfetti() {
      confettiCtx.clearRect(0, 0, confettiCanvas.width, confettiCanvas.height);
      
      confetti.forEach(c => {
        confettiCtx.save();
        confettiCtx.translate(c.x, c.y);
        confettiCtx.rotate(c.tiltAngle);
        confettiCtx.beginPath();
        confettiCtx.arc(0, 0, c.r, 0, 2 * Math.PI);
        confettiCtx.fillStyle = c.color;
        confettiCtx.fill();
        confettiCtx.restore();
      });
      
      updateConfetti();
      
      if (confetti.length > 0) {
        requestAnimationFrame(animateConfetti);
      }
    }

    function updateConfetti() {
      confetti.forEach(c => {
        c.tiltAngle += 0.1;
        c.y += c.d * 0.5;
        c.x += Math.sin(c.tiltAngle) * 2;
      });
      
      confetti = confetti.filter(c => c.y < confettiCanvas.height);
    }

    // Iniciar o primeiro jogo
    currentMaze = getRandomMaze();
    render();
  </script>
</body>
</html>
