<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Jogo de Pintar - MusiKids Fun</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Baloo+2&display=swap');
  body, html {
    margin: 0; padding: 0; height: 100%;
    background: linear-gradient(135deg, #f9ecd3 0%, #f4a261 100%);
    font-family: 'Baloo 2', cursive, Arial, sans-serif;
    user-select: none;
    overflow: hidden;
  }
  header {
    font-size: 2rem;
    color: #d76f51;
    font-weight: 900;
    text-align: center;
    padding: 0.8rem 0;
    background: #e9c46a;
    box-shadow: 0 3px 6px #bb8561aa;
    user-select: none;
    margin-bottom: 4px;
  }
  #btn-back {
    position: fixed;
    top: 15px;
    left: 15px;
    background: #2a9d8f;
    color: white;
    padding: 12px 20px;
    font-weight: 700;
    border: none;
    border-radius: 20px;
    cursor: pointer;
    box-shadow: 0 6px 15px #2a9d8fcc;
    transition: background-color 0.3s ease;
    z-index: 1000;
  }
  #btn-back:hover {
    background: #21867a;
  }
  #toolbar {
    position: fixed;
    top: 60px;
    left: 15px;
    background: #264653cc;
    padding: 10px;
    border-radius: 20px;
    display: flex;
    flex-direction: column;
    gap: 12px;
    z-index: 900;
  }
  .tool-btn {
    width: 44px;
    height: 44px;
    border-radius: 14px;
    border: none;
    background: #ffffffdd;
    cursor: pointer;
    box-shadow: 0 4px 9px #00000033;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 24px;
    color: #264653;
    transition: background-color 0.25s ease;
  }
  .tool-btn.selected {
    background: #2a9d8f;
    color: white;
  }
  .tool-btn:hover {
    background: #d8f3dc;
  }
  #canvas-container {
    margin-left: 90px;
    margin-top: 60px;
    height: calc(100vh - 60px);
    overflow: auto;
  }
  svg#paint-area {
    border: 3px solid #264653;
    border-radius: 20px;
    background: #fff9f0;
    max-width: 95vw;
    max-height: 85vh;
    display: block;
    margin: auto;
  }
  path.outline {
    stroke: #264653;
    stroke-width: 3;
    fill: none;
  }
  path.fillable {
    fill: white;
    stroke: #264653;
    stroke-width: 2;
    cursor: pointer;
  }
</style>
</head>
<body>

<button id="btn-back" aria-label="Voltar ao menu de jogos" title="Voltar ao menu">‚Üê Menu</button>

<div id="toolbar" role="toolbar" aria-label="Ferramentas de Pintura">
  <button class="tool-btn selected" id="tool-pencil" title="L√°pis - pintar livre" aria-pressed="true" aria-label="Selecionar L√°pis">‚úèÔ∏è</button>
  <button class="tool-btn" id="tool-brush" title="Pincel - tra√ßo grosso" aria-pressed="false" aria-label="Selecionar Pincel">üñåÔ∏è</button>
  <button class="tool-btn" id="tool-eraser" title="Borracha - apagar pintura" aria-pressed="false" aria-label="Selecionar Borracha">ü©π</button>
  <button class="tool-btn" id="tool-bucket" title="Balde de tinta - preencher" aria-pressed="false" aria-label="Selecionar Balde de Tinta">ü™£</button>
  <button class="tool-btn" id="btn-clear" title="Limpar tudo" aria-label="Limpar pintura">üßπ</button>
</div>

<div id="canvas-container">
  <svg id="paint-area" viewBox="0 0 600 400" role="img" aria-label="√Årea de pintura">
    <!-- Contornos do desenho para o balde preencher -->
    <path class="outline" d="M150 100 C 180 80, 210 80, 240 100 S 270 130, 300 110" />
    <path class="outline" d="M400 150 Q 430 120, 460 150 T 520 160" />
    <!-- √Åreas coloridas para preencher com balde -->
    <path class="fillable" data-fill default-fill="#ffffff" d="M100,100 L200,100 L200,200 L100,200 Z" />
    <path class="fillable" data-fill default-fill="#ffffff" d="M350,120 L450,120 L450,220 L350,220 Z" />
  </svg>
</div>

<script>
  const btnBack = document.getElementById('btn-back');
  btnBack.onclick = () => {
    location.href = '../index.html'; // volta ao menu principal
  };

  const tools = {
    pencil: document.getElementById('tool-pencil'),
    brush: document.getElementById('tool-brush'),
    eraser: document.getElementById('tool-eraser'),
    bucket: document.getElementById('tool-bucket'),
    clear: document.getElementById('btn-clear'),
  };
  let currentTool = 'pencil';

  const paintArea = document.getElementById('paint-area');
  const svgNS = "http://www.w3.org/2000/svg";
  let drawing = false;
  let currentPath = null;
  let pathData = '';

  function selectTool(toolName) {
    currentTool = toolName;
    Object.keys(tools).forEach(key => {
      if(tools[key].classList) {
        tools[key].classList.toggle('selected', key === toolName);
        tools[key].setAttribute('aria-pressed', key === toolName);
      }
    });
  }
  tools.pencil.onclick = () => selectTool('pencil');
  tools.brush.onclick = () => selectTool('brush');
  tools.eraser.onclick = () => selectTool('eraser');
  tools.bucket.onclick = () => selectTool('bucket');
  tools.clear.onclick = () => clearPainting();

  function createNewPath() {
    const p = document.createElementNS(svgNS, 'path');
    p.setAttribute('fill', 'none');
    p.setAttribute('stroke', '#000');
    if(currentTool === 'brush') {
      p.setAttribute('stroke-width', '8');
      p.setAttribute('stroke-linejoin', 'round');
      p.setAttribute('stroke-linecap', 'round');
    } else {
      p.setAttribute('stroke-width', '2');
      p.setAttribute('stroke-linejoin', 'round');
      p.setAttribute('stroke-linecap', 'round');
    }
    paintArea.appendChild(p);
    return p;
  }

  paintArea.addEventListener('mousedown', e => {
    if(currentTool === 'bucket') return; // balde usa click diferente
    drawing = true;
    const pt = getSVGPoint(e);
    pathData = `M ${pt.x} ${pt.y}`;
    currentPath = createNewPath();
    currentPath.setAttribute('d', pathData);
    if(currentTool === 'eraser') {
      currentPath.setAttribute('stroke', '#fff');
      currentPath.setAttribute('stroke-width', '12');
    }
  });
  paintArea.addEventListener('mousemove', e => {
    if(!drawing || !currentPath) return;
    const pt = getSVGPoint(e);
    pathData += ` L ${pt.x} ${pt.y}`;
    currentPath.setAttribute('d', pathData);
  });
  paintArea.addEventListener('mouseup', e => {
    drawing = false;
    currentPath = null;
  });
  paintArea.addEventListener('mouseleave', e => {
    drawing = false;
    currentPath = null;
  });

  // Balde de tinta - preenche √°rea clicada
  paintArea.querySelectorAll('path.fillable').forEach(path => {
    path.addEventListener('click', e => {
      if(currentTool !== 'bucket') return;
      let color = '#000000'; // cor padr√£o se nenhuma for selecionada
      // pegar cor do l√°pis ou pincel selecionado (no exemplo, sempre preto)
      if(currentTool === 'bucket') color = '#ff4c8b'; 
      path.setAttribute('fill', color);
    });
  });

  function clearPainting() {
    // Remove todos paths que n√£o sejam fillable
    [...paintArea.querySelectorAll('path')].forEach(path => {
      if(path.classList.contains('fillable')) {
        path.setAttribute('fill', path.getAttribute('default-fill') || 'white');
      } else {
        path.remove();
      }
    });
    instructions.textContent = '';
  }

  function getSVGPoint(event) {
    const pt = paintArea.createSVGPoint();
    pt.x = event.clientX;
    pt.y = event.clientY;
    return pt.matrixTransform(paintArea.getScreenCTM().inverse());
  }
</script>
</body>
</html>
